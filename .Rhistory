axis.text.x = element_text(angle = 45, hjust = 1))
# Combining the stacked line plots and box plot
p_combined_resale <- p_line_resale_stacked / p_box_resale
# Print the combined plot
print(p_combined_resale)
#|fig-height:30
# Filter resale transactions and create a Quarter variable
resale_data <- data_cleaned %>%
filter(`Type of Sale` == "Resale") %>%
mutate(Quarter = as.yearqtr(`Sale Date`))
# Use all resale data for the line plot
avg_price_by_quarter_resale <- resale_data %>%
group_by(Area_Category, Quarter) %>%
summarise(Avg_Unit_Price_PSM = mean(`Unit Price ($ PSM)`, na.rm = TRUE), .groups = "drop")
# Create separate line plots for each area category
p_line_resale <- avg_price_by_quarter_resale %>%
ggplot(aes(x = Quarter, y = Avg_Unit_Price_PSM, group = Area_Category, color = Area_Category)) +
geom_line() +
labs(title = "Quarterly Average Unit Price ($ PSM) by Area Category for Resale",
x = "Quarter",
y = "Average Price ($ PSM)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
# Separate line plots for each area category, stacked vertically
p_line_resale_stacked <- p_line_resale + facet_wrap(~Area_Category, ncol = 1, scales = "free_y")
# Filter data for Q1 2024 for the box plot
data_q1_resale <- resale_data %>%
filter(Quarter == "2024 Q1") %>%
mutate(Month = floor_date(`Sale Date`, "month"))
# Box plot of monthly unit prices by area category for Q1 2024 resale transactions
p_box_resale <- ggplot(data_q1_resale, aes(x = Area_Category, y = `Unit Price ($ PSM)`, fill = Area_Category)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.001) +  # Adjusting alpha for visibility
facet_wrap(~Month, scales = "free_y") +
labs(title = "Monthly Unit Price ($ PSM) by Area Category for Resale (Q1 2024)",
x = "Area Category",
y = "Price ($ PSM)") +
theme_minimal() +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1))
# Combining the stacked line plots and box plot
p_combined_resale <- p_line_resale_stacked / p_box_resale
# Print the combined plot
print(p_combined_resale)
#|fig-height:30
# Filter resale transactions and create a Quarter variable
resale_data <- data_cleaned %>%
filter(`Type of Sale` == "Resale") %>%
mutate(Quarter = as.yearqtr(`Sale Date`))
# Use all resale data for the line plot
avg_price_by_quarter_resale <- resale_data %>%
group_by(Area_Category, Quarter) %>%
summarise(Avg_Unit_Price_PSM = mean(`Unit Price ($ PSM)`, na.rm = TRUE), .groups = "drop")
# Create separate line plots for each area category
p_line_resale <- avg_price_by_quarter_resale %>%
ggplot(aes(x = Quarter, y = Avg_Unit_Price_PSM, group = Area_Category, color = Area_Category)) +
geom_line() +
labs(title = "Quarterly Average Unit Price ($ PSM) by Area Category for Resale",
x = "Quarter",
y = "Average Price ($ PSM)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
# Separate line plots for each area category, stacked vertically
p_line_resale_stacked <- p_line_resale + facet_wrap(~Area_Category, ncol = 1, scales = "free_y")
# Filter data for Q1 2024 for the box plot
data_q1_resale <- resale_data %>%
filter(Quarter == "2024 Q1") %>%
mutate(Month = floor_date(`Sale Date`, "month"))
# Box plot of monthly unit prices by area category for Q1 2024 resale transactions
p_box_resale <- ggplot(data_q1_resale, aes(x = Area_Category, y = `Unit Price ($ PSM)`, fill = Area_Category)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.001) +  # Adjusting alpha for visibility
facet_wrap(~Month, scales = "free_y") +
labs(title = "Monthly Unit Price ($ PSM) by Area Category for Resale (Q1 2024)",
x = "Area Category",
y = "Price ($ PSM)") +
theme_minimal() +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1))
# Combining the stacked line plots and box plot
p_combined_resale <- p_line_resale_stacked / p_box_resale
# Print the combined plot
print(p_combined_resale)
#|fig-height: 30
# Filter resale transactions and create a Quarter variable
resale_data <- data_cleaned %>%
filter(`Type of Sale` == "Resale") %>%
mutate(Quarter = as.yearqtr(`Sale Date`))
# Use all resale data for the line plot
avg_price_by_quarter_resale <- resale_data %>%
group_by(Area_Category, Quarter) %>%
summarise(Avg_Unit_Price_PSM = mean(`Unit Price ($ PSM)`, na.rm = TRUE), .groups = "drop")
# Create separate line plots for each area category
p_line_resale <- avg_price_by_quarter_resale %>%
ggplot(aes(x = Quarter, y = Avg_Unit_Price_PSM, group = Area_Category, color = Area_Category)) +
geom_line() +
labs(title = "Quarterly Average Unit Price ($ PSM) by Area Category for Resale",
x = "Quarter",
y = "Average Price ($ PSM)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
# Separate line plots for each area category, stacked vertically
p_line_resale_stacked <- p_line_resale + facet_wrap(~Area_Category, ncol = 1, scales = "free_y")
# Filter data for Q1 2024 for the box plot
data_q1_resale <- resale_data %>%
filter(Quarter == "2024 Q1") %>%
mutate(Month = floor_date(`Sale Date`, "month"))
# Box plot of monthly unit prices by area category for Q1 2024 resale transactions
p_box_resale <- ggplot(data_q1_resale, aes(x = Area_Category, y = `Unit Price ($ PSM)`, fill = Area_Category)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.001) +  # Adjusting alpha for visibility
facet_wrap(~Month, scales = "free_y") +
labs(title = "Monthly Unit Price ($ PSM) by Area Category for Resale (Q1 2024)",
x = "Area Category",
y = "Price ($ PSM)") +
theme_minimal() +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1))
# Combining the stacked line plots and box plot
p_combined_resale <- p_line_resale_stacked / p_box_resale
# Print the combined plot
print(p_combined_resale)
#|fig-height: 15
# Filter resale transactions and create a Quarter variable
resale_data <- data_cleaned %>%
filter(`Type of Sale` == "Resale") %>%
mutate(Quarter = as.yearqtr(`Sale Date`))
# Use all resale data for the line plot
avg_price_by_quarter_resale <- resale_data %>%
group_by(Area_Category, Quarter) %>%
summarise(Avg_Unit_Price_PSM = mean(`Unit Price ($ PSM)`, na.rm = TRUE), .groups = "drop")
# Create separate line plots for each area category
p_line_resale <- avg_price_by_quarter_resale %>%
ggplot(aes(x = Quarter, y = Avg_Unit_Price_PSM, group = Area_Category, color = Area_Category)) +
geom_line() +
labs(title = "Quarterly Average Unit Price ($ PSM) by Area Category for Resale",
x = "Quarter",
y = "Average Price ($ PSM)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
# Separate line plots for each area category, stacked vertically
p_line_resale_stacked <- p_line_resale + facet_wrap(~Area_Category, ncol = 1, scales = "free_y")
# Filter data for Q1 2024 for the box plot
data_q1_resale <- resale_data %>%
filter(Quarter == "2024 Q1") %>%
mutate(Month = floor_date(`Sale Date`, "month"))
# Box plot of monthly unit prices by area category for Q1 2024 resale transactions
p_box_resale <- ggplot(data_q1_resale, aes(x = Area_Category, y = `Unit Price ($ PSM)`, fill = Area_Category)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.001) +  # Adjusting alpha for visibility
facet_wrap(~Month, scales = "free_y") +
labs(title = "Monthly Unit Price ($ PSM) by Area Category for Resale (Q1 2024)",
x = "Area Category",
y = "Price ($ PSM)") +
theme_minimal() +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1))
# Combining the stacked line plots and box plot
p_combined_resale <- p_line_resale_stacked / p_box_resale
# Print the combined plot
print(p_combined_resale)
#|fig-height: 18
# Filter resale transactions and create a Quarter variable
resale_data <- data_cleaned %>%
filter(`Type of Sale` == "Resale") %>%
mutate(Quarter = as.yearqtr(`Sale Date`))
# Use all resale data for the line plot
avg_price_by_quarter_resale <- resale_data %>%
group_by(Area_Category, Quarter) %>%
summarise(Avg_Unit_Price_PSM = mean(`Unit Price ($ PSM)`, na.rm = TRUE), .groups = "drop")
# Create separate line plots for each area category
p_line_resale <- avg_price_by_quarter_resale %>%
ggplot(aes(x = Quarter, y = Avg_Unit_Price_PSM, group = Area_Category, color = Area_Category)) +
geom_line() +
labs(title = "Quarterly Average Unit Price ($ PSM) by Area Category for Resale",
x = "Quarter",
y = "Average Price ($ PSM)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
# Separate line plots for each area category, stacked vertically
p_line_resale_stacked <- p_line_resale + facet_wrap(~Area_Category, ncol = 1, scales = "free_y")
# Filter data for Q1 2024 for the box plot
data_q1_resale <- resale_data %>%
filter(Quarter == "2024 Q1") %>%
mutate(Month = floor_date(`Sale Date`, "month"))
# Box plot of monthly unit prices by area category for Q1 2024 resale transactions
p_box_resale <- ggplot(data_q1_resale, aes(x = Area_Category, y = `Unit Price ($ PSM)`, fill = Area_Category)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.001) +  # Adjusting alpha for visibility
facet_wrap(~Month, scales = "free_y") +
labs(title = "Monthly Unit Price ($ PSM) by Area Category for Resale (Q1 2024)",
x = "Area Category",
y = "Price ($ PSM)") +
theme_minimal() +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1))
# Combining the stacked line plots and box plot
p_combined_resale <- p_line_resale_stacked / p_box_resale
# Print the combined plot
print(p_combined_resale)
#| fig-width: 12
library(dplyr)
library(ggplot2)
library(patchwork)
# Assuming data_cleaned is your initial dataset which has already been cleaned
# Filter the dataset for resale transactions only
resale_data <- data_cleaned %>%
filter(`Type of Sale` == "Resale")
# Calculate project statistics for resale transactions
project_stats <- resale_data %>%
filter(`Project Name` != "N.A.") %>%
group_by(`Project Name`) %>%
summarise(
Total_Units = sum(`Number of Units`, na.rm = TRUE),  # Sum up all units for each project
Avg_Unit_Price = mean(`Unit Price ($ PSM)`, na.rm = TRUE),  # Calculate the average price per square meter
.groups = "drop"  # Drop the grouping
)
# Get the top 25 projects by total units for resale transactions
top_projects <- project_stats %>%
top_n(25, Total_Units) %>%
arrange(desc(Total_Units))
# Define the order for 'Project Name' based on 'Total_Units' in 'top_projects'
project_order <- top_projects$`Project Name`
# Ensure the project order is the same for both plots by setting factor levels
top_projects$`Project Name` <- factor(top_projects$`Project Name`, levels = project_order)
resale_data$`Project Name` <- factor(resale_data$`Project Name`, levels = project_order)
# Create a bar chart for Total Number of Units
p_units <- ggplot(top_projects, aes(x = `Project Name`, y = Total_Units, fill = 'steelblue')) +
geom_bar(stat = "identity") +
labs(y = "Total Number of Units") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
legend.position = "none"
)
# Create a box plot for Unit Price ($ PSM)
p_price <- ggplot(resale_data, aes(x = `Project Name`, y = `Unit Price ($ PSM)`)) +
geom_boxplot() +
labs(y = "Unit Price ($ PSM)") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
legend.position = "none"
)
# Combine the two plots side by side
p_combined <- p_units | p_price
# Display the combined plot
p_combined
#| fig-width: 12
#| fig-height: 18
# Filter resale transactions and create a Quarter variable
resale_data <- data_cleaned %>%
filter(`Type of Sale` == "Resale") %>%
mutate(Quarter = as.yearqtr(`Sale Date`))
# Use all resale data for the line plot
avg_price_by_quarter_resale <- resale_data %>%
group_by(Area_Category, Quarter) %>%
summarise(Avg_Unit_Price_PSM = mean(`Unit Price ($ PSM)`, na.rm = TRUE), .groups = "drop")
# Create separate line plots for each area category
p_line_resale <- avg_price_by_quarter_resale %>%
ggplot(aes(x = Quarter, y = Avg_Unit_Price_PSM, group = Area_Category, color = Area_Category)) +
geom_line() +
labs(title = "Quarterly Average Unit Price ($ PSM) by Area Category for Resale",
x = "Quarter",
y = "Average Price ($ PSM)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
# Separate line plots for each area category, stacked vertically
p_line_resale_stacked <- p_line_resale + facet_wrap(~Area_Category, ncol = 1, scales = "free_y")
# Filter data for Q1 2024 for the box plot
data_q1_resale <- resale_data %>%
filter(Quarter == "2024 Q1") %>%
mutate(Month = floor_date(`Sale Date`, "month"))
# Box plot of monthly unit prices by area category for Q1 2024 resale transactions
p_box_resale <- ggplot(data_q1_resale, aes(x = Area_Category, y = `Unit Price ($ PSM)`, fill = Area_Category)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.001) +  # Adjusting alpha for visibility
facet_wrap(~Month, scales = "free_y") +
labs(title = "Monthly Unit Price ($ PSM) by Area Category for Resale (Q1 2024)",
x = "Area Category",
y = "Price ($ PSM)") +
theme_minimal() +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1))
# Combining the stacked line plots and box plot
p_combined_resale <- p_line_resale_stacked / p_box_resale
# Print the combined plot
print(p_combined_resale)
#| fig-width: 12
#| fig-height: 18
# Filter resale transactions and create a Quarter variable
resale_data <- data_cleaned %>%
filter(`Type of Sale` == "Resale") %>%
mutate(Quarter = as.yearqtr(`Sale Date`))
# Use all resale data for the line plot
avg_price_by_quarter_resale <- resale_data %>%
group_by(Area_Category, Quarter) %>%
summarise(Avg_Unit_Price_PSM = mean(`Unit Price ($ PSM)`, na.rm = TRUE), .groups = "drop")
# Create separate line plots for each area category
p_line_resale <- avg_price_by_quarter_resale %>%
ggplot(aes(x = Quarter, y = Avg_Unit_Price_PSM, group = Area_Category, color = Area_Category)) +
geom_line() +
labs(title = "Quarterly Average Unit Price ($ PSM) by Area Category for Resale",
x = "Quarter",
y = "Average Price ($ PSM)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
# Separate line plots for each area category, stacked vertically
p_line_resale_stacked <- p_line_resale + facet_wrap(~Area_Category, ncol = 1, scales = "free_y")
# Filter data for Q1 2024 for the box plot
data_q1_resale <- resale_data %>%
filter(Quarter == "2024 Q1") %>%
mutate(Month = floor_date(`Sale Date`, "month"))
# Box plot of monthly unit prices by area category for Q1 2024 resale transactions
p_box_resale <- ggplot(data_q1_resale, aes(x = Area_Category, y = `Unit Price ($ PSM)`, fill = Area_Category)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.001) +  # Adjusting alpha for visibility
facet_wrap(~Month, scales = "free_y") +
labs(title = "Monthly Unit Price ($ PSM) by Area Category for Resale (Q1 2024)",
x = "Area Category",
y = "Price ($ PSM)") +
theme_minimal() +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1))
# Combining the stacked line plots and box plot
p_combined_resale <- p_line_resale_stacked / p_box_resale
# Print the combined plot
print(p_combined_resale)
#| fig-width: 12
#| fig-height: 18
print(p_combined_resale)
resale_data <- data_cleaned %>%
filter(`Type of Sale` == "Resale")
project_stats <- resale_data %>%
filter(`Project Name` != "N.A.") %>%
group_by(`Project Name`) %>%
summarise(
Total_Units = sum(`Number of Units`, na.rm = TRUE),  # Sum up all units for each project
Avg_Unit_Price = mean(`Unit Price ($ PSM)`, na.rm = TRUE),  # Calculate the average price per square meter
.groups = "drop"  # Drop the grouping
)
top_projects <- project_stats %>%
top_n(25, Total_Units) %>%
arrange(desc(Total_Units))
project_order <- top_projects$`Project Name`
top_projects$`Project Name` <- factor(top_projects$`Project Name`, levels = project_order)
resale_data$`Project Name` <- factor(resale_data$`Project Name`, levels = project_order)
p_units <- ggplot(top_projects, aes(x = `Project Name`, y = Total_Units, fill = 'steelblue')) +
geom_bar(stat = "identity") +
labs(y = "Total Number of Units") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
legend.position = "none"
)
p_price <- ggplot(resale_data, aes(x = `Project Name`, y = `Unit Price ($ PSM)`)) +
geom_boxplot() +
labs(y = "Unit Price ($ PSM)") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
legend.position = "none"
)
p_combined <- p_units | p_price
#| fig-width: 12
p_combined
resale_data <- data_cleaned %>%
filter(`Type of Sale` == "Resale") %>%
mutate(Quarter = as.yearqtr(`Sale Date`))
avg_price_by_quarter_resale <- resale_data %>%
group_by(Area_Category, Quarter) %>%
summarise(Avg_Unit_Price_PSM = mean(`Unit Price ($ PSM)`, na.rm = TRUE), .groups = "drop")
p_line_resale <- avg_price_by_quarter_resale %>%
ggplot(aes(x = Quarter, y = Avg_Unit_Price_PSM, group = Area_Category, color = Area_Category)) +
geom_line() +
labs(title = "Quarterly Average Unit Price ($ PSM) by Area Category for Resale",
x = "Quarter",
y = "Average Price ($ PSM)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
p_line_resale_stacked <- p_line_resale + facet_wrap(~Area_Category, ncol = 1, scales = "free_y")
data_q1_resale <- resale_data %>%
filter(Quarter == "2024 Q1") %>%
mutate(Month = floor_date(`Sale Date`, "month"))
p_box_resale <- ggplot(data_q1_resale, aes(x = Area_Category, y = `Unit Price ($ PSM)`, fill = Area_Category)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.001) +  # Adjusting alpha for visibility
facet_wrap(~Month, scales = "free_y") +
labs(title = "Monthly Unit Price ($ PSM) by Area Category for Resale (Q1 2024)",
x = "Area Category",
y = "Price ($ PSM)") +
theme_minimal() +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1))
p_combined_resale <- p_line_resale_stacked / p_box_resale
#| fig-width: 12
#| fig-height: 18
print(p_combined_resale)
pacman::p_load(tidyverse, lubridate, ggplot2,patchwork,zoo)
#| fig-width: 12
#| fig-height: 8
p_combined
#| fig-width: 12
#| fig-height: 12
p_combined
#| fig-width: 12
#| fig-height: 10
p_combined
pacman::p_load(tidyverse, lubridate, patchwork, zoo)
data1 = read_csv("data/ResidentialTransaction20240308160536.csv")
data2 = read_csv("data/ResidentialTransaction20240308160736.csv")
data3 = read_csv("data/ResidentialTransaction20240308161009.csv")
data4 = read_csv("data/ResidentialTransaction20240308161109.csv")
data5 = read_csv("data/ResidentialTransaction20240414220633.csv")
data <- bind_rows(data1, data2, data3, data4, data5)
glimpse(data)
data_cleaned <- data %>%
mutate(
`Sale Date` = dmy(`Sale Date`),  # Ensuring we're using the exact column name from the dataset
`Area (SQM)` = as.numeric(gsub(",", "", `Area (SQM)`)),  # Keeping the variable names as they are in the dataset
`Unit Price ($ PSM)` = as.numeric(gsub("\\$", "", gsub(",", "", `Unit Price ($ PSM)`)))  # Properly referencing the variable
)
data_cleaned <- data_cleaned %>%
mutate(
`Area (SQM)` = ifelse(is.na(`Area (SQM)`), 0, `Area (SQM)`)  # Dealing with NA values
)
data_cleaned <- data_cleaned %>%
mutate(
Area_Category = cut(
`Area (SQM)`,
breaks = c(0, 100, 200, 300, 400, Inf),
labels = c("<100", "100-200", "200-300", "300-400", ">400"),
include.lowest = TRUE
)
)
resale_data <- data_cleaned %>%
filter(`Type of Sale` == "Resale") %>%
mutate(Quarter = as.yearqtr(`Sale Date`))
avg_price_by_quarter_resale <- resale_data %>%
group_by(Area_Category, Quarter) %>%
summarise(Avg_Unit_Price_PSM = mean(`Unit Price ($ PSM)`, na.rm = TRUE), .groups = "drop")
p_line_resale <- avg_price_by_quarter_resale %>%
ggplot(aes(x = Quarter, y = Avg_Unit_Price_PSM, group = Area_Category, color = Area_Category)) +
geom_line() +
labs(title = "Quarterly Average Unit Price ($ PSM) by Area Category for Resale",
x = "Quarter",
y = "Average Price ($ PSM)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
p_line_resale_stacked <- p_line_resale + facet_wrap(~Area_Category, ncol = 1, scales = "free_y")
data_q1_resale <- resale_data %>%
filter(Quarter == "2024 Q1") %>%
mutate(Month = floor_date(`Sale Date`, "month"))
p_box_resale <- ggplot(data_q1_resale, aes(x = Area_Category, y = `Unit Price ($ PSM)`, fill = Area_Category)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.001) +  # Adjusting alpha for visibility
facet_wrap(~Month, scales = "free_y") +
labs(title = "Monthly Unit Price ($ PSM) by Area Category for Resale (Q1 2024)",
x = "Area Category",
y = "Price ($ PSM)") +
theme_minimal() +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1))
p_combined_resale <- p_line_resale_stacked / p_box_resale
#| fig-width: 12
#| fig-height: 18
print(p_combined_resale)
resale_data <- data_cleaned %>%
filter(`Type of Sale` == "Resale")
project_stats <- resale_data %>%
filter(`Project Name` != "N.A.") %>%
group_by(`Project Name`) %>%
summarise(
Total_Units = sum(`Number of Units`, na.rm = TRUE),  # Sum up all units for each project
Avg_Unit_Price = mean(`Unit Price ($ PSM)`, na.rm = TRUE),  # Calculate the average price per square meter
.groups = "drop"  # Drop the grouping
)
top_projects <- project_stats %>%
top_n(25, Total_Units) %>%
arrange(desc(Total_Units))
project_order <- top_projects$`Project Name`
top_projects$`Project Name` <- factor(top_projects$`Project Name`, levels = project_order)
resale_data$`Project Name` <- factor(resale_data$`Project Name`, levels = project_order)
p_units <- ggplot(top_projects, aes(x = `Project Name`, y = Total_Units, fill = 'steelblue')) +
geom_bar(stat = "identity") +
labs(y = "Total Number of Units") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
legend.position = "none"
)
p_price <- ggplot(resale_data, aes(x = `Project Name`, y = `Unit Price ($ PSM)`)) +
geom_boxplot() +
labs(y = "Unit Price ($ PSM)") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
legend.position = "none"
)
p_combined <- p_units | p_price
#| fig-width: 12
#| fig-height: 10
p_combined
